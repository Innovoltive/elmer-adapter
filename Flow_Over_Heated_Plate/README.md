# Example Problem: Partitioned Heat Conduction

Refer to [flow-over-heated-plate](https://precice.org/tutorials-flow-over-heated-plate.html) for a detailed explanation of the case.

## Contents of this Folder

* `precice-config.xml`: A preCICE configuration for explicit coupling
* `README.md`: The file you are currently reading
* Five folders:
  * `Reference_Problem/`: Contains the monolithic reference solution
  * `Fluid-elmer/`: Fluid domain solved with Elmer
  * `Fluid-openfoam/`: Fluid domain solved with OpenFOAM
  * `Solid-elmer/`: Solid domain solved with Elmer
  * `Solid-openfoam/`: Solid domain solved with OpenFOAM
  
Each simulation folder contains a `case.sif` file, which is the system input file generated by ElmerGUI (or written by hand), to be fed to `ElmerSolver` together with the mesh files to run the simulation.

## Running the Reference Example

The example is provided in three different versions: 
1. A reference case where the problem is solved monolithically
2. Coupled cases where each domain can be solved by Elmer or OpenFOAM

To run the reference simulation:

1. Navigate to the `Reference_Problem/` directory
2. Run the simulation: `ElmerSolver case.sif` (for the monolithic case, you only need to run a single process)
3. Visualize results: Results are stored in the output folder (`out`) and can be visualized using ParaView

> **Hint**: The location of the output results can be modified in the `.sif` file under the `Header` section.

## Running the Coupled Simulation for Elmer-Elmer Coupling

This scenario uses two independent Elmer simulations - one for the Dirichlet participant and one for the Neumann participant. Follow these steps for `Fluid-elmer` and `Solid-Elmer`:

1. Open two terminals (or use `tmux`) and navigate to each of the folders
2. Run the simulation by executing `ElmerSolver case.sif` in each folder
   * **Important**: Make sure there is no `precice-run` folder in the parent directory as this can cause issues
3. Visualize results: Results are stored in the results folder (`out`) and can be visualized using ParaView

> **Hint**: To compare the results with the reference problem, open both VTK files in the `out` folder and use the `Group Datasets` filter in ParaView


## Running the Coupled Simulation for Elmer-OpenFOAM Coupling

1. Open two terminals (or use `tmux`) and navigate to each of the required folders
2. In the first terminal:
   ```bash
   cd Fluid-openfoam
   blockMesh
   buoyantPimpleFoam
   ```
3. In the second terminal:
   ```bash
   cd Solid-elmer
   ElmerSolver case.sif
   ```

You should see that both terminals display logs (potentially updating very rapidly).

You can also use Elmer as the fluid sovler and openfoam as the solid solver. The only differnece is that in the openfoam you need to run. 

```bash
blockMesh
laplacianFoam
```


## Troubleshooting

If you encounter problems, try cleaning up the environment by running:

```bash
./clean.sh
```

This script removes folders generated from previous simulations. **Note**: It also deletes results.

## Additional Resources

For more information, please refer to the [ElmerGUI Tutorials](http://www.nic.funet.fi/pub/sci/physics/elmer/doc/ElmerTutorials.pdf).
